var App={Controllers:{_controllers:[],add:function(e,t){if("function"!=typeof t)return this;if("object"==typeof e)for(var n=0;n<e.length;n++)this._controllers.push([e[n],t]);else"string"==typeof e&&this._controllers.push([e,t]);return this},call:function(){for(var e=$("body:first").attr("id"),t=0;t<this._controllers.length;t++)e=="body."+this._controllers[t][0]&&this._controllers[t][1](this._controllers[t][0])}},Components:{_elements:[],_modules:[],add:function(e,t,n){return"function"!=typeof t?this:(this._elements.push([e,t,n||0]),this)},addModule:function(e,t,n){return"function"!=typeof t?this:(this._modules.push([e,t,n||0]),this)},call:function(e){for(var t=0;t<this._elements.length;t++){var n=this._elements[t];_.isArray(e)&&-1!=_.indexOf(e,n[0])?n[1]():e==n[0]&&n[1]()}},init:function(e){this._elements=_.sortBy(this._elements,2),this._modules=_.sortBy(this._modules,2);for(i in this._elements){var t=this._elements[i];try{e?_.isArray(e)&&-1!=_.indexOf(e,t[0])?t[1]():e==t[0]&&t[1]():t[1]()}catch(n){console.log(t[0],n)}}var o=[];$("[data-module]").each(function(){o.push($(this).data("module"))}),o=_.uniq(o);for(i in this._modules){var e=this._modules[i],a=e[0];-1!=_.indexOf(o,a)&&e[1]()}}},Messages:{init:function(){"undefined"!=typeof MESSAGE_ERRORS&&(this.parse(MESSAGE_ERRORS,"error"),this.parse(MESSAGE_SUCCESS),$("body").on("show_message",$.proxy(function(){var e=_.toArray(arguments).slice(1);this.parse(e)},this)))},parse:function(e,t){for(text in e)"_external"!=text?this.show(e[text],t):this.parse(e[text],t)},show:function(e,t,n){t||(t="success"),window.top.noty({layout:"topRight",type:t,icon:n||"fa fa-ok",text:decodeURIComponent(e)})},error:function(e){this.show(e,"error")}},Dialog:{confirm:function(e,t,n,o){bootbox.confirm({title:n||"Подтверждение действия",message:e,className:"modal-alert modal-warning",closeButton:!1,callback:function(e){e&&t()},buttons:{confirm:{label:"Да",className:"btn-success btn-lg"},cancel:{label:"Нет",className:"btn-default btn-lg"}}})}},Loader:{counter:0,getLastId:function(){return this.counter},init:function(e,t){void 0===e||e instanceof jQuery?void 0===e&&(e=$("body")):e=$(e),++this.counter;var n=$('<div class="_loader_container"><span class="_loader_preloader" /></div>');return void 0!==t&&(t instanceof jQuery?n.append(t):n.append('<span class="_loader_message">'+t+"</span>")),n.appendTo(e).css({width:e.outerWidth(!0),height:e.outerHeight(!0),top:e.offset().top-$(window).scrollTop(),left:e.offset().left-$(window).scrollLeft()}).prop("id","loader"+this.getLastId())},show:function(e,t,n){var n=n||500;return this.init(e,t).fadeTo(n,.7),this.counter},hide:function(e){e?cont=$("#loader"+e):cont=$("._loader_container"),cont.stop().fadeOut(400,function(){$(this).remove()})}}};App.Components.add("ajaxSetup",function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})}).add("notySetup",function(){$.noty.defaults=$.extend($.noty.defaults,{layout:"topRight",theme:"relax",timeout:3e3})}).add("validator.default",function(){"function"==typeof jQuery.fn.validator&&$.validator.setDefaults({highlight:function(e){var t=$(e);t.hasClass("select2-offscreen")?$("#s2id_"+t.attr("id")+" ul").closest(".form-group").addClass("has-error"):t.closest(".form-group").addClass("has-error")},unhighlight:function(e){var t=$(e);t.hasClass("select2-offscreen")?$("#s2id_"+t.attr("id")+" ul").closest(".form-group").removeClass("has-error").find("help-block-hidden").removeClass("help-block-hidden").addClass("help-block").show():t.closest(".form-group").removeClass("has-error").find("help-block-hidden").removeClass("help-block-hidden").addClass("help-block").show()},errorElement:"p",errorClass:"jquery-validate-error help-block",errorPlacement:function(e,t){var n,o,a;return a=t.is('input[type="checkbox"]')||t.is('input[type="radio"]'),o=t.closest(".form-group").find(".jquery-validate-error").length,a&&o?void 0:(o||t.closest(".form-group").find(".help-block").removeClass("help-block").addClass("help-block-hidden").hide(),e.addClass("help-block"),a?t.closest('[class*="col-"]').append(e):(n=t.parent(),n.is(".input-group")?n.parent().append(e):n.append(e)))}})}).add("datepicker",function(){if("function"==typeof jQuery.fn.datetimepicker){var e={format:"Y-m-d H:i:00",lang:LOCALE,dayOfWeekStart:1};$(".input-datetime").each(function(){var t=$.extend({},e),n=$(this);n.data("range-max-input")&&(t.onShow=function(e){var t=$(n.data("range-max-input"));this.setOptions({maxDate:t.val()?t.val():!1})}),n.data("range-min-input")&&(t.onShow=function(e){var t=$(n.data("range-min-input"));this.setOptions({minDate:t.val()?t.val():!1})}),n.datetimepicker(t)}),$(".input-date").each(function(){var t=$.extend(e,{timepicker:!1,format:"Y-m-d"}),n=$(this);n.data("range-max-input")?t.onShow=function(e){var t=$(n.data("range-max-input"));this.setOptions({maxDate:t.val()?t.val():!1})}:n.data("range-min-input")&&(t.onShow=function(e){var t=$(n.data("range-min-input"));this.setOptions({minDate:t.val()?t.val():!1})}),n.datetimepicker(t)})}}).add("icon",function(){$("*[data-icon]").add("*[data-icon-prepend]").each(function(){var e=$(this).data("icon");$(this).hasClass("btn-labeled")&&(e+=" btn-label icon"),$(this).html('<i class="icon-'+e+'"></i> '+$(this).html()),$(this).removeAttr("data-icon-prepend").removeAttr("data-icon")}),$("*[data-icon-append]").each(function(){$(this).html($(this).html()+'&nbsp&nbsp<i class="icon-'+$(this).data("icon-append")+'"></i>'),$(this).removeAttr("data-icon-append")})}),App.Components.add("register.validator",function(){$.countdown.setDefaults($.countdown.regionalOptions.ru),$("#countDown").countdown({until:new Date(2016,0,1)}),$(".comingSoon").backstretch(["/img/coming_soon.jpg"],{fade:1e3}),$("#registerForm").validate({rules:{username:{required:!0},email:{required:!0,email:!0},password:{required:!0,minlength:3,maxlength:20},password_confirmation:{required:!0,minlength:3,maxlength:20,equalTo:'input[name="password"]'}},messages:{email:{required:"Please enter your email address",email:"Please enter a VALID email address"},password:{required:"Please enter your password"},password_confirmation:{required:"Please enter your password one more time",equalTo:"Please enter the same password as above"}}})}),$(function(){function e(){App.Components.init(),App.Controllers.call(),App.Messages.init()}$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),e()});